warning: No `requires-python` value found in the workspace. Defaulting to `>=3.12`.
2025-12-16 18:43:25,653 - INFO - Building SAM2-MoE model...
2025-12-16 18:43:26,510 - INFO - MoE adapter keys not loaded (expected): 704 keys
2025-12-16 18:43:26,511 - INFO - Loaded checkpoint sucessfully
2025-12-16 18:43:26,585 - INFO - Loading MoE checkpoint: outputs/ocid_training_tb/checkpoint-best.pt
2025-12-16 18:43:26,721 - INFO - Validation samples: 36 batches
2025-12-16 18:43:26,721 - INFO - Evaluation run 1/10 (seed=42)
Loaded 142 sequences for train
Loaded 36 sequences for val
Run 1:   0%|          | 0/36 [00:00<?, ?it/s]Run 1:   3%|▎         | 1/36 [00:00<00:24,  1.43it/s]Run 1:  14%|█▍        | 5/36 [00:00<00:04,  7.63it/s]Run 1:  25%|██▌       | 9/36 [00:00<00:02, 13.02it/s]Run 1:  33%|███▎      | 12/36 [00:01<00:01, 16.29it/s]Run 1:  44%|████▍     | 16/36 [00:01<00:00, 20.11it/s]Run 1:  56%|█████▌    | 20/36 [00:01<00:00, 23.05it/s]Run 1:  64%|██████▍   | 23/36 [00:01<00:00, 24.67it/s]Run 1:  75%|███████▌  | 27/36 [00:01<00:00, 26.32it/s]Run 1:  86%|████████▌ | 31/36 [00:01<00:00, 27.67it/s]Run 1:  94%|█████████▍| 34/36 [00:01<00:00, 28.05it/s]Run 1: 100%|██████████| 36/36 [00:01<00:00, 18.89it/s]
2025-12-16 18:43:28,635 - INFO - Evaluation run 2/10 (seed=1042)
Run 2:   0%|          | 0/36 [00:00<?, ?it/s]Run 2:   3%|▎         | 1/36 [00:00<00:18,  1.91it/s]Run 2:  14%|█▍        | 5/36 [00:00<00:03,  9.51it/s]Run 2:  22%|██▏       | 8/36 [00:00<00:02, 13.96it/s]Run 2:  31%|███       | 11/36 [00:00<00:01, 17.65it/s]Run 2:  39%|███▉      | 14/36 [00:00<00:01, 20.47it/s]Run 2:  47%|████▋     | 17/36 [00:01<00:00, 22.84it/s]Run 2:  56%|█████▌    | 20/36 [00:01<00:00, 24.67it/s]Run 2:  64%|██████▍   | 23/36 [00:01<00:00, 26.06it/s]Run 2:  72%|███████▏  | 26/36 [00:01<00:00, 26.60it/s]Run 2:  83%|████████▎ | 30/36 [00:01<00:00, 27.61it/s]Run 2:  92%|█████████▏| 33/36 [00:01<00:00, 28.07it/s]Run 2: 100%|██████████| 36/36 [00:01<00:00, 20.34it/s]
2025-12-16 18:43:30,407 - INFO - Evaluation run 3/10 (seed=2042)
Run 3:   0%|          | 0/36 [00:00<?, ?it/s]Run 3:   3%|▎         | 1/36 [00:00<00:15,  2.28it/s]Run 3:  11%|█         | 4/36 [00:00<00:03,  9.05it/s]Run 3:  19%|█▉        | 7/36 [00:00<00:02, 14.35it/s]Run 3:  28%|██▊       | 10/36 [00:00<00:01, 18.07it/s]Run 3:  36%|███▌      | 13/36 [00:00<00:01, 20.83it/s]Run 3:  44%|████▍     | 16/36 [00:00<00:00, 22.16it/s]Run 3:  53%|█████▎    | 19/36 [00:01<00:00, 20.09it/s]Run 3:  61%|██████    | 22/36 [00:01<00:00, 21.25it/s]Run 3:  72%|███████▏  | 26/36 [00:01<00:00, 23.91it/s]Run 3:  81%|████████  | 29/36 [00:01<00:00, 24.75it/s]Run 3:  89%|████████▉ | 32/36 [00:01<00:00, 26.02it/s]Run 3: 100%|██████████| 36/36 [00:01<00:00, 28.04it/s]Run 3: 100%|██████████| 36/36 [00:01<00:00, 19.95it/s]
2025-12-16 18:43:32,212 - INFO - Evaluation run 4/10 (seed=3042)
Run 4:   0%|          | 0/36 [00:00<?, ?it/s]Run 4:   3%|▎         | 1/36 [00:00<00:13,  2.51it/s]Run 4:  11%|█         | 4/36 [00:00<00:03,  9.26it/s]Run 4:  19%|█▉        | 7/36 [00:00<00:02, 13.62it/s]Run 4:  31%|███       | 11/36 [00:00<00:01, 18.90it/s]Run 4:  42%|████▏     | 15/36 [00:00<00:00, 22.44it/s]Run 4:  50%|█████     | 18/36 [00:01<00:00, 24.02it/s]Run 4:  61%|██████    | 22/36 [00:01<00:00, 25.93it/s]Run 4:  69%|██████▉   | 25/36 [00:01<00:00, 26.54it/s]Run 4:  78%|███████▊  | 28/36 [00:01<00:00, 27.22it/s]Run 4:  86%|████████▌ | 31/36 [00:01<00:00, 27.85it/s]Run 4:  94%|█████████▍| 34/36 [00:01<00:00, 25.83it/s]Run 4: 100%|██████████| 36/36 [00:01<00:00, 21.01it/s]
2025-12-16 18:43:33,928 - INFO - Evaluation run 5/10 (seed=4042)
Run 5:   0%|          | 0/36 [00:00<?, ?it/s]Run 5:   3%|▎         | 1/36 [00:00<00:16,  2.06it/s]Run 5:  11%|█         | 4/36 [00:00<00:03,  8.28it/s]Run 5:  22%|██▏       | 8/36 [00:00<00:01, 14.63it/s]Run 5:  31%|███       | 11/36 [00:00<00:01, 17.82it/s]Run 5:  39%|███▉      | 14/36 [00:00<00:01, 20.64it/s]Run 5:  47%|████▋     | 17/36 [00:01<00:00, 22.14it/s]Run 5:  56%|█████▌    | 20/36 [00:01<00:00, 23.50it/s]Run 5:  64%|██████▍   | 23/36 [00:01<00:00, 24.98it/s]Run 5:  72%|███████▏  | 26/36 [00:01<00:00, 25.92it/s]Run 5:  83%|████████▎ | 30/36 [00:01<00:00, 27.56it/s]Run 5:  94%|█████████▍| 34/36 [00:01<00:00, 28.53it/s]Run 5: 100%|██████████| 36/36 [00:01<00:00, 20.60it/s]
2025-12-16 18:43:35,677 - INFO - Evaluation run 6/10 (seed=5042)
Run 6:   0%|          | 0/36 [00:00<?, ?it/s]Run 6:   3%|▎         | 1/36 [00:00<00:17,  2.05it/s]Run 6:  11%|█         | 4/36 [00:00<00:04,  7.87it/s]Run 6:  17%|█▋        | 6/36 [00:00<00:02, 10.63it/s]Run 6:  22%|██▏       | 8/36 [00:00<00:02, 12.59it/s]Run 6:  28%|██▊       | 10/36 [00:00<00:01, 14.22it/s]Run 6:  33%|███▎      | 12/36 [00:01<00:01, 15.56it/s]Run 6:  39%|███▉      | 14/36 [00:01<00:01, 16.48it/s]Run 6:  44%|████▍     | 16/36 [00:01<00:01, 17.30it/s]Run 6:  50%|█████     | 18/36 [00:01<00:01, 16.82it/s]Run 6:  58%|█████▊    | 21/36 [00:01<00:00, 20.21it/s]Run 6:  67%|██████▋   | 24/36 [00:01<00:00, 22.59it/s]Run 6:  78%|███████▊  | 28/36 [00:01<00:00, 25.44it/s]Run 6:  86%|████████▌ | 31/36 [00:01<00:00, 26.05it/s]Run 6:  94%|█████████▍| 34/36 [00:01<00:00, 23.57it/s]Run 6: 100%|██████████| 36/36 [00:02<00:00, 17.22it/s]
2025-12-16 18:43:37,769 - INFO - Evaluation run 7/10 (seed=6042)
Run 7:   0%|          | 0/36 [00:00<?, ?it/s]Run 7:   3%|▎         | 1/36 [00:00<00:16,  2.09it/s]Run 7:  14%|█▍        | 5/36 [00:00<00:03, 10.20it/s]Run 7:  22%|██▏       | 8/36 [00:00<00:01, 14.72it/s]Run 7:  31%|███       | 11/36 [00:00<00:01, 18.42it/s]Run 7:  42%|████▏     | 15/36 [00:00<00:00, 21.86it/s]Run 7:  53%|█████▎    | 19/36 [00:01<00:00, 24.55it/s]Run 7:  64%|██████▍   | 23/36 [00:01<00:00, 26.45it/s]Run 7:  75%|███████▌  | 27/36 [00:01<00:00, 27.75it/s]Run 7:  83%|████████▎ | 30/36 [00:01<00:00, 27.87it/s]Run 7:  94%|█████████▍| 34/36 [00:01<00:00, 28.57it/s]Run 7: 100%|██████████| 36/36 [00:01<00:00, 21.21it/s]
2025-12-16 18:43:39,467 - INFO - Evaluation run 8/10 (seed=7042)
Run 8:   0%|          | 0/36 [00:00<?, ?it/s]Run 8:   3%|▎         | 1/36 [00:00<00:14,  2.48it/s]Run 8:  11%|█         | 4/36 [00:00<00:03,  9.36it/s]Run 8:  19%|█▉        | 7/36 [00:00<00:01, 14.66it/s]Run 8:  28%|██▊       | 10/36 [00:00<00:01, 16.23it/s]Run 8:  36%|███▌      | 13/36 [00:00<00:01, 19.59it/s]Run 8:  44%|████▍     | 16/36 [00:00<00:00, 21.61it/s]Run 8:  53%|█████▎    | 19/36 [00:01<00:00, 23.80it/s]Run 8:  61%|██████    | 22/36 [00:01<00:00, 25.07it/s]Run 8:  69%|██████▉   | 25/36 [00:01<00:00, 25.54it/s]Run 8:  78%|███████▊  | 28/36 [00:01<00:00, 26.77it/s]Run 8:  89%|████████▉ | 32/36 [00:01<00:00, 28.32it/s]Run 8: 100%|██████████| 36/36 [00:01<00:00, 29.59it/s]Run 8: 100%|██████████| 36/36 [00:01<00:00, 21.03it/s]
2025-12-16 18:43:41,179 - INFO - Evaluation run 9/10 (seed=8042)
Run 9:   0%|          | 0/36 [00:00<?, ?it/s]Run 9:   3%|▎         | 1/36 [00:00<00:18,  1.94it/s]Run 9:   8%|▊         | 3/36 [00:00<00:05,  5.67it/s]Run 9:  17%|█▋        | 6/36 [00:00<00:02, 11.17it/s]Run 9:  25%|██▌       | 9/36 [00:00<00:01, 15.72it/s]Run 9:  36%|███▌      | 13/36 [00:00<00:01, 20.01it/s]Run 9:  44%|████▍     | 16/36 [00:01<00:00, 20.72it/s]Run 9:  56%|█████▌    | 20/36 [00:01<00:00, 23.69it/s]Run 9:  64%|██████▍   | 23/36 [00:01<00:00, 24.33it/s]Run 9:  75%|███████▌  | 27/36 [00:01<00:00, 25.96it/s]Run 9:  86%|████████▌ | 31/36 [00:01<00:00, 27.18it/s]Run 9:  94%|█████████▍| 34/36 [00:01<00:00, 27.64it/s]Run 9: 100%|██████████| 36/36 [00:01<00:00, 19.62it/s]
2025-12-16 18:43:43,015 - INFO - Evaluation run 10/10 (seed=9042)
Run 10:   0%|          | 0/36 [00:00<?, ?it/s]Run 10:   3%|▎         | 1/36 [00:00<00:17,  1.97it/s]Run 10:  14%|█▍        | 5/36 [00:00<00:03,  9.74it/s]Run 10:  22%|██▏       | 8/36 [00:00<00:01, 14.02it/s]Run 10:  33%|███▎      | 12/36 [00:00<00:01, 18.83it/s]Run 10:  44%|████▍     | 16/36 [00:01<00:00, 22.28it/s]Run 10:  53%|█████▎    | 19/36 [00:01<00:00, 23.58it/s]Run 10:  61%|██████    | 22/36 [00:01<00:00, 24.47it/s]Run 10:  72%|███████▏  | 26/36 [00:01<00:00, 26.28it/s]Run 10:  81%|████████  | 29/36 [00:01<00:00, 25.41it/s]Run 10:  92%|█████████▏| 33/36 [00:01<00:00, 27.34it/s]Run 10: 100%|██████████| 36/36 [00:01<00:00, 20.38it/s]
2025-12-16 18:43:44,783 - INFO - Results saved to: outputs/evaluation/results.json
2025-12-16 18:43:44,784 - INFO - Report saved to: outputs/evaluation/evaluation_report.md

================================================================================
# SAM2-MoE Segmentation Evaluation Report

Generated: 2025-12-16 18:43:44

**Model:** SAM2-MoE Base+
**Number of runs:** 10

## Summary

| Metric | Value |
|--------|-------|
| PQ | 0.0464±0.0000 |
| AP@0.5 | 0.0833±0.0000 |
| Pixel IoU | 0.2111±0.0000 |
| F1 | 0.0833±0.0000 |

## Detailed Results

### Panoptic Quality Metrics

| Metric | Mean | Std |
|--------|------|-----|
| PQ | 0.0464 | 0.0000 |
| SQ | 0.0464 | 0.0000 |
| RQ | 0.0833 | 0.0000 |

### Average Precision

| Metric | Mean | Std |
|--------|------|-----|
| AP | 0.0278 | 0.0000 |
| AP@0.5 | 0.0833 | 0.0000 |
| AP@0.75 | 0.0000 | 0.0000 |
| AP@0.9 | 0.0000 | 0.0000 |

### IoU Metrics

| Metric | Mean | Std |
|--------|------|-----|
| Mean IoU | 0.1258 | 0.0000 |
| Pixel IoU | 0.2111 | 0.0000 |
| Mean Dice | 0.1966 | 0.0000 |

### Detection Metrics

| Metric | Value |
|--------|-------|
| Total TP | 12 |
| Total FP | 132 |
| Total FN | 132 |
| Precision | 0.0833±0.0000 |
| Recall | 0.0833±0.0000 |
| F1 | 0.0833±0.0000 |

---

### Evaluation Configuration

- Seeds used: [42, 1042, 2042, 3042, 4042, 5042, 6042, 7042, 8042, 9042]
- Number of samples: 144


================================================================================
